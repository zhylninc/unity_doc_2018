<html><head><title>html模版</title></head><body>Unity - Manual:  Accessing and Modifying Material parameters via script</br>
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (2018.1 beta)</a></li>
<li><a href="Graphics.html">Graphics</a></li>
<li><a href="GraphicsOverview.html">Graphics Overview</a></li>
<li><a href="Shaders.html">Materials, Shaders &amp; Textures</a></li>
<li> Accessing and Modifying Material parameters via script</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="StandardShaderMakeYourOwn.html"></a></span><div class="tip">Make your own</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="ShadersOverview.html"></a></span><div class="tip">Writing Shaders</div>
</div>
</div></div>
<div class="otherversionswrapper" onmouseover="setOtherVersionsDisplay(true)" onmouseout="setOtherVersionsDisplay(false)">
<a>Other Versions</a><div class="otherversionscontent" id="OtherVersionsContent" style="display: none;">Cannot access other versions offline!</div>
</div>
<div class="scrollToFeedback"><a id="scrollToFeedback">Leave feedback</a></div>
<h1>Accessing and Modifying Material parameters via script</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>All the parameters of a Material that you see in the inspector when viewing a material are accessible via script, giving you the power to change or animate how a material works at runtime.</p>

<p>This allows you to modify numeric values on the Material, change colours, and swap textures dynamically during gameplay. Some of the most commonly used functions to do this are:</p>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Function Name</th>
	<th style="text-align:left;">Use</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="../ScriptReference/Material.SetColor.html">SetColor</a></td>
	<td style="text-align:left;">Change the color of a material (Eg. the albedo tint color)</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="../ScriptReference/Material.SetFloat.html">SetFloat</a></td>
	<td style="text-align:left;">Set a floating point value (Eg. the normal map multiplier)</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="../ScriptReference/Material.SetInt.html">SetInt</a></td>
	<td style="text-align:left;">Set an integer value in the material</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="../ScriptReference/Material.SetTexture.html">SetTexture</a></td>
	<td style="text-align:left;">Assign a new texture to the material</td>
</tr>
</tbody>
</table>

<p>The full set of functions available for manipulating materials via script can be found on the <a href="../ScriptReference/Material.html">Material class scripting reference</a>.</p>

<p>One important note is that these functions <strong>only set properties that are available for the current shader</strong> on the material. This means that if you have a shader that doesn’t use any textures, or if you have no shader bound at all, calling <a href="../ScriptReference/Material.SetTexture.html">SetTexture</a> will have no effect. This is true even if you later set a shader that needs the texture. For this reason it is recommended to set the shader you want before setting any properties, however once you’ve done that you can switch from one shader to another that use the same textures or properties and values will be preserved.</p>

<p>These functions work as you would expect for all <em>simple</em> shaders such as the legacy shaders, and the built-in shaders <em>other than the Standard Shader</em> (for example, the particle, sprite, UI and unlit shaders). For a material using the <em>Standard Shader</em> however, there are some further requirements which you must be aware of before being able to fully modify the Material.</p>

<h2>Special requirements for Scripting with the Standard Shader</h2>

<p>The Standard Shader has some extra requirements if you want to modify Materials at runtime, because - behind the scenes - it is actually many different shaders rolled into one.</p>

<p>These different types of shader are called <a href="SL-MultipleProgramVariants.html">Shader Variants</a> and can be thought of as all the different possible combinations of the shader’s features, when activated or not activated.</p>

<p>For example, if you choose to assign a <a href="StandardShaderMaterialParameterNormalMap.html">Normal Map</a> to your material, you activate that <em>variant</em> of the shader which supports Normal Mapping. If you subsequently also assign a <a href="StandardShaderMaterialParameterHeightMap.html">Height Map</a> then you activate the variant of the shader which supports Normal Mapping and Height Mapping.</p>

<p>This is a good system, because it means that if you use the Standard Shader, but do not use a Normal Map in a certain Material, you are not incurring the performance cost of running the Normal Map shader code - because you are running a variant of the shader with that code omitted. It also means that if you never use a certain feature combination (such as HeightMap &amp; Emissive together), that variant is completely omitted from your build - and in practice you will typically only use a very small number of the possible variants of the Standard Shader.</p>

<p>Unity avoids simply including every possible shader variant in your build, because this would be a very large number, some tens of thousands! This high number is a result not only of each possible combination of features available in the material inspector, but also there are variants of each feature combination for differing rendering scenarios such as whether or not HDR is being used, lightmaps, GI, fog, etc. Including all of these would cause slow loading, high memory consumption, and increase your build size and build time.</p>

<p>Instead, Unity tracks which variants you’ve used by examining the material assets used in your project. Whichever variants of the Standard Shader you have included in your project, those are the variants which are included in the build.</p>

<p>This presents two separate problems when accessing materials via script that use the Standard Shader.</p>

<h3>1. You must enable the correct Keywords for your required Standard Shader variant</h3>

<p>If you use scripting to change a Material that would cause it to use a different variant of the Standard Shader, you must <strong>enable that variant by using the <a href="../ScriptReference/Material.EnableKeyword.html">EnableKeyword</a> function</strong>. A different variant would be required if you start using a shader feature that was not initially in use by the material. For example assigning a Normal Map to a Material that did not have one, or setting the Emissive level to a value greater than zero, when it was previously zero.</p>

<p>The specific Keywords required to enable the Standard Shader features are as follows:</p>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Keyword</th>
	<th style="text-align:left;">Feature</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">_NORMALMAP</td>
	<td style="text-align:left;"><a href="StandardShaderMaterialParameterNormalMap.html">Normal Mapping</a></td>
</tr>
<tr>
	<td style="text-align:left;">_ALPHATEST_ON</td>
	<td style="text-align:left;">
<a href="StandardShaderMaterialParameterRenderingMode.html">“Cut out” Transparency</a> Rendering Mode</td>
</tr>
<tr>
	<td style="text-align:left;">_ALPHABLEND_ON</td>
	<td style="text-align:left;">
<a href="StandardShaderMaterialParameterRenderingMode.html">“Fade” Transparency</a> Rendering Mode</td>
</tr>
<tr>
	<td style="text-align:left;">_ALPHAPREMULTIPLY_ON</td>
	<td style="text-align:left;">
<a href="StandardShaderMaterialParameterRenderingMode.html">“Transparent” Transparency</a> Rendering Mode</td>
</tr>
<tr>
	<td style="text-align:left;">_EMISSION</td>
	<td style="text-align:left;">
<a href="StandardShaderMaterialParameterEmission.html">Emission Colour</a> or <a href="StandardShaderMaterialParameterEmission.html">Emission Mapping</a>
</td>
</tr>
<tr>
	<td style="text-align:left;">_PARALLAXMAP</td>
	<td style="text-align:left;"><a href="StandardShaderMaterialParameterHeightMap.html">Height Mapping</a></td>
</tr>
<tr>
	<td style="text-align:left;">_DETAIL_MULX2</td>
	<td style="text-align:left;">
<a href="StandardShaderMaterialParameterDetail.html">Secondary “Detail” Maps</a> (Albedo &amp; Normal Map)</td>
</tr>
<tr>
	<td style="text-align:left;">_METALLICGLOSSMAP</td>
	<td style="text-align:left;">
<a href="StandardShaderMaterialParameterMetallic.html">Metallic/Smoothness Mapping</a> in Metallic Workflow</td>
</tr>
<tr>
	<td style="text-align:left;">_SPECGLOSSMAP</td>
	<td style="text-align:left;">
<a href="StandardShaderMaterialParameterSpecular.html">Specular/Smoothness Mapping</a> in Specular Workflow</td>
</tr>
</tbody>
</table>

<p>Using the keywords above is enough to get your scripted Material modifications working while running in the editor.</p>

<p>However, because Unity only checks for Materials used in your project to determine which variants to include in your build, it will not include variants that are <em>only</em> encountered via script at runtime.</p>

<p>This means if you enable the _PARALLAXMAP keyword for a Material in your script, but you do not have a Material used in your project matching that same feature combination, the parallax mapping will not work in your final build - even though it appears to work in the editor. This is because that variant will have been omitted from the build because it seemed to not be required.</p>

<h3>2. You must make sure Unity includes your required shader variants in the build</h3>

<p>To do this, you need to make sure Unity knows that you want to use that shader variant by including at least one Material of that type in your Assets. The material <strong>must be used in a scene</strong> or alternatively be placed in your <a href="LoadingResourcesatRuntime.html">Resources Folder</a> - otherwise Unity will still omit it from your build, because it appeared unused.</p>

<p>By completing both of the above steps, you have the full ability to modify your Materials using the Standard Shader at runtime.</p>

<p>If you are interested in learning more about the details of shader variants, and how to write your own, read about <a href="SL-MultipleProgramVariants.html">Making multiple shader program variants here</a>.</p>
<div class="feedbackbox" id="feedbackbox">
<div id="rating"><p>Did you find this page useful? Please give it a rating:<br><div id="ratecontent" class="c-rating"></div>
</p></div>
<div id="ratingThanks" style="display:none"><p>Thanks for rating this page!</p></div>
<div id="problem"><p><a name="problem" onclick="document.getElementById('problemType').style.display = '';document.getElementById('problem').style.display = 'none';">Report a problem on this page</a></p></div>
<div id="problemType" style="display:none"><p>What kind of problem would you like to report?<ul type="problems">
<li><a name="needcode" onclick="                                                             document.getElementById('problemType').style.display = 'none';                                                             document.getElementById('problemThanks').style.display = '';                                                             SendFeedback('problem-needcode',window.location.href,0);                                                             document.getElementById('problemFormDescription').value='Needs code samples.';                                                             document.getElementById('problemNeedCodeForm').style.display = ''                                                         ">This page needs code samples</a></li>
<li><a name="code" onclick="document.getElementById('problemType').style.display = 'none';                                                         document.getElementById('problemThanks').style.display = '';                                                         SendFeedback('problem-brokencode',window.location.href,0);                                                         document.getElementById('problemFormDescription').value='Code samples do not work.';                                                         document.getElementById('problemCodeForm').style.display = ''                                                         ">Code samples do not work</a></li>
<li><a name="missing" onclick="document.getElementById('problemType').style.display = 'none';                                                         document.getElementById('problemThanks').style.display = '';                                                         SendFeedback('problem-missing',window.location.href,0);                                                         document.getElementById('problemFormDescription').value='Missing information';                                                         document.getElementById('problemMissingForm').style.display = ''                                                         ">Information is missing</a></li>
<li><a name="incorrect" onclick="document.getElementById('problemType').style.display = 'none';                                                         document.getElementById('problemThanks').style.display = '';                                                         SendFeedback('problem-incorrect',window.location.href,0);                                                         document.getElementById('problemFormDescription').value='Incorrect information';                                                         document.getElementById('problemIncorrectForm').style.display = ''                                                         ">Information is incorrect</a></li>
<li><a name="unclear" onclick="document.getElementById('problemType').style.display = 'none';                                                         document.getElementById('problemThanks').style.display = '';                                                         SendFeedback('problem-unclear',window.location.href,0);                                                         document.getElementById('problemFormDescription').value='Unclear or confusing information';                                                         document.getElementById('problemUnclearForm').style.display = ''                                                         ">Information is unclear or confusing</a></li>
<li><a name="language" onclick="document.getElementById('problemType').style.display = 'none';                                                         document.getElementById('problemThanks').style.display = '';                                                         SendFeedback('problem-language',window.location.href,0);                                                         document.getElementById('problemFormDescription').value='Spelling or grammar error';                                                         document.getElementById('problemLanguageForm').style.display = ''                                                         ">There is a spelling/grammar error on this page</a></li>
<li><a name="other" onclick="document.getElementById('problemType').style.display = 'none';                                                         document.getElementById('problemThanks').style.display = '';                                                         SendFeedback('problem-other',window.location.href,0);                                                         document.getElementById('problemFormDescription').value='This page has a problem';                                                         document.getElementById('problemOtherForm').style.display = ''                                                         ">Something else</a></li>
</ul>
<p><known_issues><p>Is something described here not working as you expect it to? It might be a <b>Known Issue</b>. Please check with the Issue Tracker at <a href="https://issuetracker.unity3d.com">issuetracker.unity3d.com</a>.</p></known_issues></p>
</p></div>
<div id="problemThanks" style="display:none"><p>Thanks for letting us know! This page has been marked for review based on your feedback.<br><br>If you have time, you can provide more information to help us fix the problem faster.<br><br><a onclick="document.getElementById('problemMoreInfo').style.display = '';document.getElementById('problemThanks').style.display = 'none';">Provide more information</a><br>
</p></div>
<div id="problemMoreInfo" style="display:none">
<p id="problemNeedCodeForm" style="display:none">You've told us this page needs code samples. If you'd like to help us further, you could provide a code sample, or tell us about what kind of code sample you'd like to see:</p>
<p id="problemCodeForm" style="display:none">You've told us there are code samples on this page which don't work. If you know how to fix it, or have something better we could use instead, please let us know:</p>
<p id="problemMissingForm" style="display:none">You've told us there is information missing from this page. Please tell us more about what's missing:</p>
<p id="problemIncorrectForm" style="display:none">You've told us there is incorrect information on this page. If you know what we should change to make it correct, please tell us:</p>
<p id="problemUnclearForm" style="display:none">You've told us this page has unclear or confusing information. Please tell us more about what you found unclear or confusing, or let us know how we could make it clearer:</p>
<p id="problemLanguageForm" style="display:none">You've told us there is a spelling or grammar error on this page. Please tell us what's wrong:</p>
<p id="problemOtherForm" style="display:none">You've told us this page has a problem. Please tell us more about what's wrong:</p>
<form>
<textarea id="problemFormSuggestionField" cols="40" rows="5"></textarea><input type="hidden" id="problemFormDescription"><input type="submit" id="problemFormDescriptionSubmit" value="Submit" onclick="                                             document.getElementById('problemMoreInfo').style.display = 'none';                                             document.getElementById('problemMoreInfoThanks').style.display = '';                                             return false;                                             ">
</form>
</div>
<div id="problemMoreInfoThanks" style="display:none"><p>Thanks for helping to make the Unity documentation better!</p></div>
<script>

                                            var ratecontent = document.querySelector('#ratecontent'); // target element
                                            var currentRating = 0; // initial rating
                                            var maxRating= 5; // max rating

                                            // callback to run after setting the rating
                                            var callback = function(rating) {
                                                document.getElementById('ratingThanks').style.display = '';
                                                document.getElementById('ratecontent').style.display = 'none';
                                                document.getElementById('rating').style.display = 'none';
                                                SendFeedback("rating",window.location.href,rating);
                                            };

                                            // rating instance
                                            var myRating = rating(ratecontent, currentRating, maxRating, callback);
                                        </script>
</div>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="StandardShaderMakeYourOwn.html"></a></span><div class="tip">Make your own</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="ShadersOverview.html"></a></span><div class="tip">Writing Shaders</div>
</div>
</div>
</div>
</body></html>